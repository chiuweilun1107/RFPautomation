# 圖片儲存成本分析與試算

**用途**: 精確計算不同方案的成本
**適用**: 財務評估、預算規劃、技術決策
**資料來源**: Supabase Pricing (2026), Cloudinary Pricing (2026)

---

## 1. 基礎假設 (Baseline Assumptions)

### 1.1 使用量成長預測

| 時期 | 活躍專案數 | 每專案圖片數 | 平均圖片大小 | 總儲存量 | 月查看次數/張 | 總頻寬 |
|------|-----------|------------|------------|---------|-------------|-------|
| **當前** (2026 Q1) | 100 | 20 | 500KB | 1GB | 10 | 10GB |
| **優化後** (2026 Q2) | 150 | 20 | 200KB | 600MB | 10 | 6GB |
| **6 個月** (2026 Q3) | 300 | 25 | 200KB | 1.5GB | 15 | 22.5GB |
| **12 個月** (2027 Q1) | 500 | 30 | 200KB | 3GB | 20 | 60GB |
| **24 個月** (2028 Q1) | 1000 | 40 | 200KB | 8GB | 30 | 240GB |

### 1.2 成本參數

**Supabase Pricing** (2026):
- Free 方案: $0/月 (1GB 儲存, 2GB 頻寬)
- Pro 方案: $25/月 (100GB 儲存, 250GB 頻寬)
- 超量費用:
  - 儲存: $0.125/GB/月
  - 頻寬: $0.09/GB

**Cloudinary Pricing** (2026):
- Free 方案: $0/月 (25GB 儲存, 25GB 頻寬, 25 轉換學分/月)
- Plus 方案: $99/月 (190GB 儲存, 190GB 頻寬, 5500 轉換學分/月)
- 按需計費:
  - 儲存: $0.04/GB/月
  - 頻寬: $0.10/GB
  - 轉換: $0.0008/次 (估計每張圖 2 次轉換)

**自建 MinIO Pricing** (2026):
- Hetzner VM: $0 (已有 CPX31 伺服器)
- CDN (Cloudflare): 免費 (每月 10TB 流量以下)
- 維護工時: 4 小時/月 × $50/時 = $200/月

---

## 2. 詳細成本試算

### 2.1 方案 A: Supabase Storage (推薦) ✅

#### 當前成本 (未優化)

| 項目 | 用量 | 費用 |
|------|------|------|
| **儲存** | 1GB | $0 (Free 方案內) |
| **頻寬** | 10GB | $0.09 × 8GB (超出 2GB) = $0.72 |
| **合計** | | **$0.72/月** |

❌ 問題: Free 方案頻寬不足

#### 優化後成本 (壓縮圖片)

| 項目 | 用量 | 費用 |
|------|------|------|
| **儲存** | 600MB | $0 (Free 方案內) |
| **頻寬** | 6GB | $0.09 × 4GB (超出 2GB) = $0.36 |
| **合計** | | **$0.36/月** |

✅ 仍在 Free 方案內

#### 6 個月後 (2026 Q3)

| 項目 | 用量 | 費用 |
|------|------|------|
| **儲存** | 1.5GB | $0.125 × 0.5GB (超出 1GB) = $0.06 |
| **頻寬** | 22.5GB | $0.09 × 20.5GB (超出 2GB) = $1.85 |
| **合計** | | **$1.91/月** |

⚠️ 超出 Free 方案，但仍可按需計費 (< Pro 方案)

#### 12 個月後 (2027 Q1)

| 項目 | 用量 | 方案選擇 | 費用 |
|------|------|---------|------|
| **儲存** | 3GB | Pro 方案 | $25/月 (包含 100GB) |
| **頻寬** | 60GB | Pro 方案 | $25/月 (包含 250GB) |
| **合計** | | | **$25/月** |

✅ 升級 Pro 方案最划算

#### 24 個月後 (2028 Q1)

| 項目 | 用量 | 方案選擇 | 費用 |
|------|------|---------|------|
| **儲存** | 8GB | Pro 方案 | $25/月 (包含 100GB) |
| **頻寬** | 240GB | Pro 方案 | $25/月 (包含 250GB) |
| **合計** | | | **$25/月** |

✅ 仍在 Pro 方案限制內

---

### 2.2 方案 B: Cloudinary

#### 當前成本 (優化前)

假設: 1GB 儲存, 10GB 頻寬, 2000 張圖 × 2 次轉換/張 = 4000 次轉換

| 項目 | 用量 | 費用 |
|------|------|------|
| **儲存** | 1GB | $0 (Free 方案內) |
| **頻寬** | 10GB | $0 (Free 方案內) |
| **轉換** | 4000 次 | $0.0008 × 3975 (超出 25 學分) = $3.18 |
| **合計** | | **$3.18/月** |

**注意**: Cloudinary 轉換學分計算複雜，實際費用可能更高

#### 6 個月後 (2026 Q3)

| 項目 | 用量 | 費用 |
|------|------|------|
| **儲存** | 1.5GB | $0 (Free 方案內) |
| **頻寬** | 22.5GB | $0 (Free 方案內) |
| **轉換** | 7500 次 (3750 張 × 2) | $0.0008 × 7475 = $5.98 |
| **合計** | | **$5.98/月** |

#### 12 個月後 (2027 Q1)

| 項目 | 用量 | 費用 |
|------|------|------|
| **儲存** | 3GB | $0 (Free 方案內) |
| **頻寬** | 60GB | $0.10 × 35GB (超出 25GB) = $3.50 |
| **轉換** | 30000 次 (15000 張 × 2) | $0.0008 × 29975 = $23.98 |
| **合計** | | **$27.48/月** |

⚠️ 超出 Supabase Pro 成本

#### 24 個月後 (2028 Q1)

| 項目 | 用量 | 方案選擇 | 費用 |
|------|------|---------|------|
| **儲存** | 8GB | Free 方案 | $0 |
| **頻寬** | 240GB | 超出 | $0.10 × 215GB = $21.50 |
| **轉換** | 80000 次 | 超出 | $0.0008 × 79975 = $63.98 |
| **合計** | | | **$85.48/月** |

❌ 或升級 Plus 方案 ($99/月)

---

### 2.3 方案 C: 混合架構

假設: 文件用 Supabase, 圖片用 Cloudinary (50% 儲存在 Cloudinary)

#### 12 個月後 (2027 Q1)

| 服務 | 項目 | 用量 | 費用 |
|------|------|------|------|
| **Supabase** | 儲存 (文件) | 1.5GB | $0.125 × 0.5GB = $0.06 |
| **Supabase** | 頻寬 (文件) | 10GB | $0.09 × 8GB = $0.72 |
| **Cloudinary** | 儲存 (圖片) | 1.5GB | $0 (Free 內) |
| **Cloudinary** | 頻寬 (圖片) | 50GB | $0.10 × 25GB = $2.50 |
| **Cloudinary** | 轉換 | 30000 次 | $0.0008 × 29975 = $23.98 |
| **額外維護工時** | 2 小時/月 | | $50 × 2 = $100 |
| **合計** | | | **$127.26/月** |

❌ 最貴方案

---

### 2.4 方案 D: 自建 MinIO

#### 12 個月後 (2027 Q1)

| 項目 | 用量 | 費用 |
|------|------|------|
| **VM 成本** | Hetzner CPX31 | $0 (已有) |
| **儲存** | 3GB | $0 (本地硬碟) |
| **CDN** | Cloudflare (60GB 頻寬) | $0 (Free 內) |
| **維護工時** | 4 小時/月 | $50 × 4 = $200 |
| **合計** | | **$200/月** |

❌ 隱性成本高

---

## 3. 方案對照總表

### 3.1 成本對照 (各時期月費)

| 時期 | Supabase | Cloudinary | 混合架構 | 自建 MinIO |
|------|---------|-----------|---------|-----------|
| **當前** (未優化) | $0.72 | $3.18 | $103.90 | $200 |
| **當前** (優化後) | $0.36 | $3.18 | $103.54 | $200 |
| **6 個月** | $1.91 | $5.98 | $106.69 | $200 |
| **12 個月** | $25 | $27.48 | $127.26 | $200 |
| **24 個月** | $25 | $85.48 | $110.20 | $200 |

**視覺化**:
```
成本趨勢圖 (月費)

$250 ┤                                                       ● MinIO ($200)
     │
$200 ┤───────────────────────────────────────────────────●────────────
     │
$150 ┤
     │                                                    ●
$100 ┤                                        ●       ●   Cloudinary
     │                            ●       ●
$50  ┤         ●               ●
     │      ●  ●            ●              ■──────────── Supabase ($25)
$25  ┤   ●                ■────────────────■────────────────────────────
     │  ■              ■
$0   └──■──────────────────────────────────────────────────────────────
     當前  6個月    12個月                  24個月

■ Supabase (最優)
● Cloudinary
● 自建 MinIO
```

---

### 3.2 累積成本對照 (24 個月總成本)

| 方案 | 0-6 個月 | 6-12 個月 | 12-24 個月 | **總計 (24 個月)** |
|------|---------|----------|-----------|------------------|
| **Supabase** | $0.36 × 6 = $2.16 | $25 × 6 = $150 | $25 × 12 = $300 | **$452.16** ✅ |
| **Cloudinary** | $3.18 × 6 = $19.08 | $27.48 × 6 = $164.88 | $85.48 × 12 = $1025.76 | **$1,209.72** ❌ |
| **混合架構** | $103.54 × 6 = $621.24 | $127.26 × 6 = $763.56 | $110.20 × 12 = $1322.40 | **$2,707.20** ❌ |
| **自建 MinIO** | $200 × 6 = $1200 | $200 × 6 = $1200 | $200 × 12 = $2400 | **$4,800** ❌ |

**結論**: Supabase 在 24 個月內節省 **$757.56 - $4,347.84**

---

## 4. 成本敏感度分析 (Sensitivity Analysis)

### 4.1 變數影響分析

**假設**: 用量增長率變化 ±50%

| 用量場景 | 12 個月儲存 | 12 個月頻寬 | Supabase 成本 | Cloudinary 成本 |
|---------|-----------|-----------|-------------|---------------|
| **保守** (-50%) | 1.5GB | 30GB | $0.95/月 | $9.98/月 |
| **基準** (0%) | 3GB | 60GB | $25/月 | $27.48/月 |
| **激進** (+50%) | 4.5GB | 90GB | $25/月 | $41.48/月 |
| **極端** (+100%) | 6GB | 120GB | $25/月 | $59.98/月 |

**觀察**:
- Supabase Pro ($25) 可應對 +100% 用量增長
- Cloudinary 成本隨用量線性增長
- 用量增長越快，Supabase 相對優勢越大

---

### 4.2 Break-even 分析 (何時 Cloudinary 更划算?)

**公式**:
```
Break-even 點 = Supabase 成本 = Cloudinary 成本
$25 = $0.04 × S + $0.10 × B + $0.0008 × T

其中:
S = 儲存 (GB)
B = 頻寬 (GB)
T = 轉換次數
```

**計算**:
假設 S = 5GB, 轉換次數 T = 圖片數 × 2

```
$25 = $0.04 × 5 + $0.10 × B + $0.0008 × (B/0.2MB × 2)
$25 = $0.20 + $0.10B + $0.008B
$24.80 = $0.108B
B = 229.6 GB/月
```

**結論**: 只有當**月頻寬超過 230GB** 時，Cloudinary 才可能更划算。但此時還需考慮轉換成本，實際 break-even 點在 **300GB+** 頻寬。

**目前頻寬**: 10GB (僅 3.3% 的 break-even 點)
**12 個月預測**: 60GB (僅 20% 的 break-even 點)

---

## 5. 隱性成本分析 (Hidden Cost Analysis)

### 5.1 開發與維護成本

| 項目 | Supabase | Cloudinary | 混合架構 | 自建 MinIO |
|------|---------|-----------|---------|-----------|
| **初始開發** (人天) | 0 | 8 | 10 | 15 |
| **開發成本** ($500/天) | $0 | $4,000 | $5,000 | $7,500 |
| **測試成本** (人天) | 0 | 3 | 4 | 5 |
| **測試成本** ($500/天) | $0 | $1,500 | $2,000 | $2,500 |
| **資料遷移風險** | $0 | $1,000 | $1,500 | $2,000 |
| **月維護工時** (小時) | 0 | 2 | 4 | 8 |
| **月維護成本** ($50/時) | $0 | $100 | $200 | $400 |
| **24 個月維護總成本** | $0 | $2,400 | $4,800 | $9,600 |

### 5.2 全生命週期成本 (Total Cost of Ownership - 24 個月)

| 方案 | 直接成本 | 開發成本 | 維護成本 | **TCO 總計** |
|------|---------|---------|---------|------------|
| **Supabase** | $452 | $0 | $0 | **$452** ✅ |
| **Cloudinary** | $1,210 | $5,500 | $2,400 | **$9,110** ❌ |
| **混合架構** | $2,707 | $7,000 | $4,800 | **$14,507** ❌ |
| **自建 MinIO** | $4,800 | $10,000 | $9,600 | **$24,400** ❌ |

**結論**: Supabase TCO 比 Cloudinary 低 **20 倍**，比自建方案低 **54 倍**。

---

## 6. 風險調整後成本 (Risk-Adjusted Cost)

### 6.1 風險因素量化

| 風險 | Supabase | Cloudinary | 混合架構 | 自建 MinIO |
|------|---------|-----------|---------|-----------|
| **服務中斷風險** (99.9% SLA) | 低 | 低 | 中 (雙依賴) | 高 (自管) |
| **成本超支風險** | 低 (固定) | 中 (用量波動) | 高 | 中 |
| **供應商鎖定風險** | 低 (S3 相容) | 中 (專有 API) | 中 | 無 |
| **技術債風險** | 無 | 中 (額外維護) | 高 | 極高 |

### 6.2 風險成本估算

| 方案 | 預期成本 (24 個月) | 風險成本估算 | **風險調整後總成本** |
|------|------------------|------------|-------------------|
| **Supabase** | $452 | $50 (服務中斷) | **$502** ✅ |
| **Cloudinary** | $9,110 | $500 (成本超支) | **$9,610** |
| **混合架構** | $14,507 | $1,500 (複雜度) | **$16,007** |
| **自建 MinIO** | $24,400 | $5,000 (維護失敗) | **$29,400** ❌ |

---

## 7. 成本優化建議

### 7.1 短期優化 (0-6 個月)

**目標**: 延長 Free 方案使用時間

1. **圖片壓縮**: 減少 60% 儲存與頻寬
   - 成本節省: $0.72 → $0.36/月 (-50%)
   - 實施成本: 4 小時 ($200)
   - ROI: 2.8 個月回本

2. **CDN 快取優化**: 提升快取命中率至 95%+
   - 成本節省: 額外減少 10-15% 頻寬
   - 實施成本: 2 小時 ($100)
   - ROI: 立即回本

3. **Lazy Loading**: 圖片按需載入
   - 成本節省: 減少 20% 不必要載入
   - 實施成本: 3 小時 ($150)
   - ROI: 3 個月回本

**總節省**: $0.36/月 + $450 實施成本 = 6 個月節省 $2.16 + 延遲升級 Pro 方案

---

### 7.2 中期優化 (6-12 個月)

**目標**: 延遲升級 Pro 方案

1. **智慧圖片格式**: WebP 優先，JPEG 備援
   - 成本節省: 額外減少 30% 檔案大小
   - 實施成本: 6 小時 ($300)

2. **縮圖服務**: 僅上傳原圖，動態生成縮圖
   - 成本節省: 減少 50% 重複儲存
   - 實施成本: 8 小時 ($400)

3. **過期檔案清理**: 定期刪除 > 1 年未使用檔案
   - 成本節省: 減少 10-20% 儲存
   - 實施成本: 4 小時 ($200)

---

### 7.3 長期優化 (12-24 個月)

**目標**: 保持 Pro 方案內

1. **CDN 分層**: 熱檔案 Supabase, 冷檔案 Cloudflare R2
   - 成本節省: 大幅降低頻寬成本
   - 實施成本: 12 小時 ($600)

2. **智慧轉碼**: 根據客戶端自動選擇格式
   - 成本節省: 減少 40% 頻寬
   - 實施成本: 10 小時 ($500)

---

## 8. 決策建議總結

### 8.1 成本排名 (24 個月 TCO)

1. ✅ **Supabase Storage**: $502 (最優)
2. ❌ Cloudinary: $9,610 (18 倍)
3. ❌ 混合架構: $16,007 (31 倍)
4. ❌ 自建 MinIO: $29,400 (58 倍)

### 8.2 最終建議

**當前階段 (0-12 個月)**:
- ✅ 選擇: Supabase Storage (Free → Pro)
- ✅ 實施: 圖片壓縮優化
- ✅ 監控: 用量趨勢

**未來評估 (12-24 個月)**:
- ⚠️ 若頻寬 > 230GB/月 → 重新評估 Cloudinary
- ⚠️ 若進入電商/社交應用 → 考慮混合架構
- ✅ 否則持續使用 Supabase Pro

---

## 9. 附錄: 成本計算機

### Excel 公式 (供複製使用)

```excel
// Supabase 成本計算
=IF(Storage_GB <= 1 AND Bandwidth_GB <= 2,
    0,
    IF(Storage_GB <= 100 AND Bandwidth_GB <= 250,
        25,
        25 + MAX(0, Storage_GB - 100) * 0.125 + MAX(0, Bandwidth_GB - 250) * 0.09
    )
)

// Cloudinary 成本計算
=MAX(0, Storage_GB - 25) * 0.04 +
 MAX(0, Bandwidth_GB - 25) * 0.10 +
 MAX(0, Transformations - 25) * 0.0008
```

---

**作者**: Leo (系統架構師)
**更新日期**: 2026-01-29
**版本**: 1.0
**相關文檔**: ADR-001, 實施指南, 決策矩陣
