# 📝 easy-template-x 範本製作指南

## 🎯 核心概念

**easy-template-x 使用特殊標籤語法,在 Word 中插入動態內容,同時 100% 保留原始樣式**

---

## 📌 基本語法

### 1. **變數插入** - `{variable_name}`

在 Word 中直接輸入 `{customer_name}`,生成時會被替換為實際值。

**範例**:
```
客戶名稱: {customer_name}
專案編號: {project_id}
日期: {date}
```

**JSON 數據**:
```json
{
  "customer_name": "台積電",
  "project_id": "PRJ-2025-001",
  "date": "2025-12-31"
}
```

**生成結果**:
```
客戶名稱: 台積電
專案編號: PRJ-2025-001
日期: 2025-12-31
```

---

### 2. **條件判斷** - `{#if condition}...{/if}`

**範例**:
```
{#if score >= 60}
恭喜通過!
{/if}

{#if score < 60}
很遺憾,未通過。
{/if}
```

**JSON 數據**:
```json
{
  "score": 85
}
```

---

### 3. **循環列表** - `{#items}...{/items}`

**最強大的功能!可以自動生成表格列**

#### **文字列表**:
```
採購項目:
{#items}
- {name}: {quantity} 個
{/items}
```

**JSON 數據**:
```json
{
  "items": [
    { "name": "筆記型電腦", "quantity": 10 },
    { "name": "滑鼠", "quantity": 20 }
  ]
}
```

**生成結果**:
```
採購項目:
- 筆記型電腦: 10 個
- 滑鼠: 20 個
```

---

### 4. **動態表格** (重點!)

**在 Word 中建立表格,在第二列插入循環標籤**

| 項目 | 數量 | 單價 | 小計 |
|------|------|------|------|
| {#items}{name} | {quantity} | {price} | {total}{/items} |

**重要**: 
- `{#items}` 放在第一個儲存格
- `{/items}` 放在最後一個儲存格
- 系統會自動向下複製這一列

**JSON 數據**:
```json
{
  "items": [
    { "name": "筆電", "quantity": 10, "price": 30000, "total": 300000 },
    { "name": "滑鼠", "quantity": 20, "price": 500, "total": 10000 }
  ]
}
```

**生成結果**:

| 項目 | 數量 | 單價 | 小計 |
|------|------|------|------|
| 筆電 | 10 | 30000 | 300000 |
| 滑鼠 | 20 | 500 | 10000 |

---

### 5. **巢狀物件** - `{object.property}`

**JSON 數據**:
```json
{
  "company": {
    "name": "台積電",
    "address": "新竹科學園區"
  }
}
```

**範本**:
```
公司名稱: {company.name}
公司地址: {company.address}
```

---

## 🎨 樣式保留

### ✅ **完全保留的樣式**:

1. **字體**: 微軟正黑體、標楷體、Times New Roman
2. **大小**: 12pt、14pt、18pt
3. **顏色**: 紅色、藍色、自訂色
4. **粗體/斜體/底線**
5. **對齊方式**: 左對齊、置中、右對齊
6. **行距**: 單行、1.5 倍、2 倍
7. **表格樣式**: 框線、背景色、合併儲存格
8. **頁首/頁尾**
9. **頁碼**
10. **圖片** (需要特殊處理)

---

## 📋 範本製作步驟

### **步驟 1: 在 Word 中設計樣式**

1. 開啟 Word
2. 設定字體、大小、顏色
3. 建立表格、設定框線
4. 插入頁首/頁尾

### **步驟 2: 插入標籤**

1. 在需要動態內容的地方輸入 `{variable_name}`
2. 在表格中插入 `{#items}...{/items}`
3. 儲存為 `.docx`

### **步驟 3: 上傳範本**

1. 在系統中上傳範本
2. 系統會自動識別標籤
3. 生成表單讓用戶填寫

---

## 🧪 測試範本

使用以下 JSON 測試:

```json
{
  "project_title": "AI 自動化系統",
  "customer_name": "台積電",
  "date": "2025-12-31",
  "items": [
    { "name": "需求分析", "hours": 40, "rate": 2000, "total": 80000 },
    { "name": "系統開發", "hours": 160, "rate": 2000, "total": 320000 }
  ],
  "total_amount": 400000
}
```

---

## ⚠️ 注意事項

1. **標籤必須完整**: `{name}` 不能寫成 `{ name }` (有空格)
2. **表格循環**: `{#items}` 和 `{/items}` 必須在同一列
3. **中文支援**: 完全支援中文變數名稱
4. **檔案格式**: 必須是 `.docx`,不支援 `.doc`

---

## 🚀 進階功能

### **圖片插入** (需要額外配置)

```json
{
  "logo": {
    "_type": "image",
    "source": "base64_encoded_image_data",
    "format": "png",
    "width": 200,
    "height": 100
  }
}
```

### **多層表格**

支援表格內嵌套表格,完全保留樣式。

---

**完整範例請參考 `templates/` 目錄**

