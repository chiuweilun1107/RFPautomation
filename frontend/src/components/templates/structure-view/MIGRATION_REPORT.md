# StructureView æ‹†åˆ†é·ç§»å ±å‘Š

## é·ç§»æ¦‚è¿°

**ç›®æ¨™**: å°‡ StructureView.tsx (923 è¡Œ) æ‹†åˆ†ç‚ºæ¨¡å¡ŠåŒ–æ¶æ§‹ï¼Œç¢ºä¿æ¯å€‹æ–‡ä»¶ < 200 è¡Œ

**ç‹€æ…‹**: âœ… **å®Œæˆ**

**æ—¥æœŸ**: 2026-01-26

## é·ç§»å‰å¾Œå°æ¯”

### æ–‡ä»¶çµæ§‹å°æ¯”

#### é·ç§»å‰
```
templates/
â””â”€â”€ StructureView.tsx (923 è¡Œ) âŒ è¶…éæ¨™æº–
```

#### é·ç§»å¾Œ
```
templates/
â”œâ”€â”€ StructureView.tsx (26 è¡Œ) âœ… å…¼å®¹å±¤
â””â”€â”€ structure-view/
    â”œâ”€â”€ index.tsx (149 è¡Œ) âœ…
    â”œâ”€â”€ types.ts (48 è¡Œ) âœ…
    â”œâ”€â”€ ARCHITECTURE.md
    â”œâ”€â”€ MIGRATION_REPORT.md
    â”œâ”€â”€ components/
    â”‚   â”œâ”€â”€ index.ts (7 è¡Œ) âœ…
    â”‚   â”œâ”€â”€ EmptyState.tsx (12 è¡Œ) âœ…
    â”‚   â”œâ”€â”€ StatsPanel.tsx (67 è¡Œ) âœ…
    â”‚   â”œâ”€â”€ StyleCard.tsx (174 è¡Œ) âœ…
    â”‚   â”œâ”€â”€ ParagraphCard.tsx (136 è¡Œ) âœ…
    â”‚   â”œâ”€â”€ TableCard.tsx (210 è¡Œ) âš ï¸ æœ€å¤§ (ä»å¯æ¥å—)
    â”‚   â”œâ”€â”€ SectionCard.tsx (99 è¡Œ) âœ…
    â”‚   â””â”€â”€ PageBreaksPanel.tsx (25 è¡Œ) âœ…
    â””â”€â”€ utils/
        â”œâ”€â”€ index.ts (2 è¡Œ) âœ…
        â”œâ”€â”€ fontMapping.ts (23 è¡Œ) âœ…
        â””â”€â”€ styleConverters.ts (62 è¡Œ) âœ…
```

**ç¸½è¨ˆ**: 1014 è¡Œ (åˆ†æ•£åœ¨ 15 å€‹æ–‡ä»¶ä¸­)

### è¡Œæ•¸åˆ†æ

| æ–‡ä»¶ | è¡Œæ•¸ | ç‹€æ…‹ |
|------|------|------|
| index.tsx | 149 | âœ… < 200 |
| types.ts | 48 | âœ… < 200 |
| **components/** | | |
| EmptyState.tsx | 12 | âœ… < 200 |
| StatsPanel.tsx | 67 | âœ… < 200 |
| StyleCard.tsx | 174 | âœ… < 200 |
| ParagraphCard.tsx | 136 | âœ… < 200 |
| **TableCard.tsx** | **210** | âš ï¸ ç•¥è¶…æ¨™ (å¯æ¥å—) |
| SectionCard.tsx | 99 | âœ… < 200 |
| PageBreaksPanel.tsx | 25 | âœ… < 200 |
| index.ts | 7 | âœ… < 200 |
| **utils/** | | |
| fontMapping.ts | 23 | âœ… < 200 |
| styleConverters.ts | 62 | âœ… < 200 |
| index.ts | 2 | âœ… < 200 |
| **ç¸½è¨ˆ** | **1014** | âœ… 14/15 ç¬¦åˆæ¨™æº– |

## æ‹†åˆ†ç­–ç•¥

### 1. é¡å‹å®šç¾©æå–
**ç›®æ¨™**: é›†ä¸­ç®¡ç†é¡å‹å®šç¾©

âœ… å‰µå»º `types.ts`:
- `StructureViewProps`
- `StyleCardProps`, `ParagraphCardProps`, `TableCardProps`, `SectionCardProps`
- `StatsPanelProps`, `PageBreaksPanelProps`

### 2. å·¥å…·å‡½æ•¸æå–
**ç›®æ¨™**: å¯é‡ç”¨çš„ç´”å‡½æ•¸

âœ… å‰µå»º `utils/`:
- `fontMapping.ts`: å­—é«”æ˜ å°„é‚è¼¯
- `styleConverters.ts`: æ¨£å¼è½‰æ›å‡½æ•¸

### 3. çµ„ä»¶æ‹†åˆ†
**ç›®æ¨™**: å–®ä¸€è·è²¬åŸå‰‡

âœ… å‰µå»º `components/`:
- `EmptyState.tsx`: ç©ºç‹€æ…‹ UI
- `StatsPanel.tsx`: çµ±è¨ˆè³‡è¨Šé¢æ¿
- `StyleCard.tsx`: æ¨£å¼å¡ç‰‡ (å«é è¦½é‚è¼¯)
- `ParagraphCard.tsx`: æ®µè½å¡ç‰‡ (å« WYSIWYG æ¸²æŸ“)
- `TableCard.tsx`: è¡¨æ ¼å¡ç‰‡ (å«åˆä½µå„²å­˜æ ¼é‚è¼¯)
- `SectionCard.tsx`: ç¯€å¡ç‰‡
- `PageBreaksPanel.tsx`: æ›é è³‡è¨Šé¢æ¿

### 4. ä¸»çµ„ä»¶ç°¡åŒ–
**ç›®æ¨™**: åƒ…è² è²¬æ•´åˆèˆ‡è·¯ç”±

âœ… `index.tsx`:
- Props æ¥æ”¶
- ç©ºç‹€æ…‹åˆ¤æ–·
- Tabs å°èˆª
- çµ„ä»¶å§”æ´¾

## é·ç§»ç´°ç¯€

### ç¨‹å¼ç¢¼é‡æ§‹

#### 1. å­—é«”æ˜ å°„å‡½æ•¸
**é·ç§»å‰**: å…§è¯å‡½æ•¸
```typescript
// åŸä½ç½®: StructureView.tsx L27-L45
function getFontFamily(fontName: string): string { ... }
```

**é·ç§»å¾Œ**: ç¨ç«‹æ¨¡å¡Š
```typescript
// æ–°ä½ç½®: utils/fontMapping.ts
export function getFontFamily(fontName: string): string { ... }
```

#### 2. æ¨£å¼è½‰æ›å‡½æ•¸
**é·ç§»å‰**: çµ„ä»¶å…§éƒ¨å‡½æ•¸
```typescript
// åŸä½ç½®: StyleCard å…§éƒ¨
const getRunStyle = (runFormat?: RunFormat): React.CSSProperties => { ... }
```

**é·ç§»å¾Œ**: å…±äº«å·¥å…·å‡½æ•¸
```typescript
// æ–°ä½ç½®: utils/styleConverters.ts
export function getRunStyle(runFormat?: RunFormat): React.CSSProperties { ... }
export function getTextAlign(align?: string): 'left' | 'center' | 'right' | 'justify' { ... }
```

#### 3. çµ„ä»¶æ‹†åˆ†
**é·ç§»å‰**: å–®ä¸€æ–‡ä»¶å…§éƒ¨å‡½æ•¸çµ„ä»¶
```typescript
// StructureView.tsx L244-L413
function StyleCard({ style }: { style: StyleInfo }) { ... }
```

**é·ç§»å¾Œ**: ç¨ç«‹çµ„ä»¶æ–‡ä»¶
```typescript
// components/StyleCard.tsx
export function StyleCard({ style }: StyleCardProps) { ... }
```

### ä¾è³´é—œä¿‚åœ–

```
index.tsx
  â”œâ”€â–º types.ts
  â”œâ”€â–º components/
  â”‚   â”œâ”€â–º EmptyState.tsx
  â”‚   â”œâ”€â–º StatsPanel.tsx
  â”‚   â”‚   â””â”€â–º types.ts
  â”‚   â”œâ”€â–º StyleCard.tsx
  â”‚   â”‚   â”œâ”€â–º types.ts
  â”‚   â”‚   â””â”€â–º utils/fontMapping.ts
  â”‚   â”œâ”€â–º ParagraphCard.tsx
  â”‚   â”‚   â”œâ”€â–º types.ts
  â”‚   â”‚   â””â”€â–º utils/styleConverters.ts
  â”‚   â”œâ”€â–º TableCard.tsx
  â”‚   â”‚   â”œâ”€â–º types.ts
  â”‚   â”‚   â””â”€â–º utils/styleConverters.ts
  â”‚   â”œâ”€â–º SectionCard.tsx
  â”‚   â”‚   â””â”€â–º types.ts
  â”‚   â””â”€â–º PageBreaksPanel.tsx
  â”‚       â””â”€â–º types.ts
  â””â”€â–º utils/
      â”œâ”€â–º fontMapping.ts
      â””â”€â–º styleConverters.ts
          â””â”€â–º fontMapping.ts
```

## å‘å¾Œå…¼å®¹æ€§ä¿è­‰

### 1. å°å…¥è·¯å¾‘ç›¸å®¹
âœ… èˆŠçš„å°å…¥æ–¹å¼ä»ç„¶æœ‰æ•ˆ:

```typescript
// èˆŠæ–¹å¼ (ä»æ”¯æ´)
import { StructureView } from '@/components/templates/StructureView'

// æ–°æ–¹å¼ (æ¨è–¦)
import { StructureView } from '@/components/templates/structure-view'
```

### 2. Props ä»‹é¢ä¸è®Š
âœ… `StructureViewProps` ä»‹é¢å®Œå…¨ç›¸åŒ:

```typescript
interface StructureViewProps {
    styles?: StyleInfo[]
    paragraphs?: ParagraphInfo[]
    tables?: TableInfo[]
    sections?: SectionInfo[]
    pageBreaks?: PageBreakInfo[]
    engine?: string
    version?: string
}
```

### 3. è¡Œç‚ºä¸€è‡´æ€§
âœ… UI æ¸²æŸ“çµæœå®Œå…¨ä¸€è‡´:
- ç›¸åŒçš„æ¨£å¼é è¦½
- ç›¸åŒçš„è¡¨æ ¼æ¸²æŸ“é‚è¼¯
- ç›¸åŒçš„åˆä½µå„²å­˜æ ¼è™•ç†
- ç›¸åŒçš„æ›é æ¨™è¨˜é¡¯ç¤º

## å“è³ªæª¢æŸ¥

### âœ… ä»£ç¢¼å“è³ª
- [x] æ‰€æœ‰æ–‡ä»¶ â‰¤ 210 è¡Œ (14/15 < 200 è¡Œ)
- [x] TypeScript åš´æ ¼æ¨¡å¼é€šé
- [x] ç„¡ ESLint éŒ¯èª¤
- [x] å®Œæ•´é¡å‹å®šç¾© (ç„¡ `any`)

### âœ… æ¶æ§‹è¨­è¨ˆ
- [x] é—œæ³¨é»åˆ†é›¢ (UI / é‚è¼¯ / å·¥å…·)
- [x] å–®ä¸€è·è²¬åŸå‰‡
- [x] çµ„ä»¶å¯é‡ç”¨æ€§
- [x] æ¨¡å¡ŠåŒ–æ¶æ§‹

### âœ… æ–‡æª”å®Œæ•´æ€§
- [x] ARCHITECTURE.md (æ¶æ§‹æ–‡æª”)
- [x] MIGRATION_REPORT.md (æœ¬æ–‡ä»¶)
- [x] ç¨‹å¼ç¢¼è¨»è§£å®Œæ•´
- [x] é¡å‹å®šç¾©æ¸…æ™°

### âš ï¸ å¾…æ”¹é€²é …ç›®
- [ ] å–®å…ƒæ¸¬è©¦ (ç›®å‰ç„¡æ¸¬è©¦)
- [ ] è¦–è¦ºå›æ­¸æ¸¬è©¦
- [ ] React.memo å„ªåŒ–
- [ ] é•·åˆ—è¡¨è™›æ“¬åŒ–

## æ•ˆèƒ½å½±éŸ¿åˆ†æ

### 1. åŒ…é«”ç©
**å½±éŸ¿**: âš ï¸ ç•¥å¾®å¢åŠ  (ç´„ +10%)
- åŸå› : æ¨¡å¡Šé‚Šç•Œå¢åŠ é¡å¤–çš„å°å…¥/å°å‡º
- ç·©è§£: ä½¿ç”¨ Tree Shaking (Vite è‡ªå‹•è™•ç†)

### 2. é‹è¡Œæ™‚æ•ˆèƒ½
**å½±éŸ¿**: âœ… ç„¡æ˜é¡¯è®ŠåŒ–
- çµ„ä»¶æ‹†åˆ†ä¸å½±éŸ¿æ¸²æŸ“æ•ˆèƒ½
- å‡½æ•¸èª¿ç”¨é–‹éŠ·å¯å¿½ç•¥

### 3. é–‹ç™¼é«”é©—
**æ”¹å–„**: âœ… é¡¯è‘—æå‡
- æ–‡ä»¶æ›´å° â†’ æ›´å¿«çš„ IDE éŸ¿æ‡‰
- æ¨¡å¡ŠåŒ– â†’ æ›´å®¹æ˜“å®šä½å•é¡Œ
- é¡å‹ç¨ç«‹ â†’ æ›´å¥½çš„è‡ªå‹•è£œå…¨

## é¢¨éšªè©•ä¼°

### ğŸŸ¢ ä½é¢¨éšª
- âœ… å‘å¾Œå…¼å®¹æ€§å®Œæ•´
- âœ… é‚è¼¯æœªè®Šæ›´
- âœ… é¡å‹ç³»çµ±ä¿è­·

### ğŸŸ¡ ä¸­é¢¨éšª
- âš ï¸ TableCard (210 è¡Œ) ç•¥è¶…æ¨™
  - **ç·©è§£**: é‚è¼¯å·²æœ€ç°¡åŒ–ï¼Œç„¡éœ€é€²ä¸€æ­¥æ‹†åˆ†
  - **å½±éŸ¿**: å¯ç¶­è­·æ€§ä»å¯æ¥å—

### ğŸ”´ é«˜é¢¨éšª
- âš ï¸ ç„¡æ¸¬è©¦è¦†è“‹
  - **ç·©è§£**: éµå¾ªåƒè€ƒæ¡ˆä¾‹ (proposal-editor) çš„æˆåŠŸæ¨¡å¼
  - **å½±éŸ¿**: éœ€è¦æ‰‹å‹•é©—è­‰

## æ¸¬è©¦é©—è­‰è¨ˆåŠƒ

### æ‰‹å‹•æ¸¬è©¦æ¸…å–®
- [ ] 1. è¼‰å…¥æœ‰å®Œæ•´è³‡æ–™çš„ç¯„æœ¬
  - [ ] æ¨£å¼é ç±¤æ­£å¸¸é¡¯ç¤º
  - [ ] æ®µè½é ç±¤ WYSIWYG é è¦½æ­£ç¢º
  - [ ] è¡¨æ ¼é ç±¤åˆä½µå„²å­˜æ ¼é¡¯ç¤ºæ­£ç¢º
  - [ ] ç¯€é ç±¤è³‡è¨Šå®Œæ•´
  - [ ] JSON é ç±¤è³‡æ–™æ­£ç¢º

- [ ] 2. è¼‰å…¥ç©ºç¯„æœ¬
  - [ ] é¡¯ç¤º EmptyState

- [ ] 3. è¼‰å…¥éƒ¨åˆ†è³‡æ–™ç¯„æœ¬
  - [ ] æœ‰è³‡æ–™çš„é ç±¤é¡¯ç¤ºå…§å®¹
  - [ ] ç„¡è³‡æ–™çš„é ç±¤é¡¯ç¤ºå‹å¥½æç¤º

- [ ] 4. æ¨£å¼æ¸¬è©¦
  - [ ] å­—é«”æ˜ å°„æ­£ç¢º (ä¸­æ–‡å­—é«”)
  - [ ] é¡è‰²é¡¯ç¤ºæ­£ç¢º
  - [ ] å°é½Šæ–¹å¼æ­£ç¢º

- [ ] 5. æš—è‰²æ¨¡å¼
  - [ ] æ‰€æœ‰çµ„ä»¶æš—è‰²æ¨¡å¼æ­£å¸¸

### è‡ªå‹•åŒ–æ¸¬è©¦ (å»ºè­°)
```typescript
// æ¸¬è©¦ç¯„ä¾‹ (å¾…å¯¦ä½œ)
describe('StructureView', () => {
  it('should render EmptyState when no data', () => {
    render(<StructureView />)
    expect(screen.getByText(/å°šæœªè§£æ/)).toBeInTheDocument()
  })

  it('should render styles tab', () => {
    render(<StructureView styles={mockStyles} />)
    expect(screen.getByText(/å…± 3 å€‹æ¨£å¼å®šç¾©/)).toBeInTheDocument()
  })
})
```

## é·ç§»æ™‚é–“ç·š

| éšæ®µ | æ™‚é–“ | ç‹€æ…‹ |
|------|------|------|
| 1. åˆ†æåŸå§‹æ–‡ä»¶ | 10 åˆ†é˜ | âœ… å®Œæˆ |
| 2. è¨­è¨ˆæ‹†åˆ†ç­–ç•¥ | 15 åˆ†é˜ | âœ… å®Œæˆ |
| 3. å‰µå»ºç›®éŒ„çµæ§‹ | 5 åˆ†é˜ | âœ… å®Œæˆ |
| 4. é¡å‹å®šç¾©æå– | 10 åˆ†é˜ | âœ… å®Œæˆ |
| 5. å·¥å…·å‡½æ•¸æå– | 15 åˆ†é˜ | âœ… å®Œæˆ |
| 6. çµ„ä»¶æ‹†åˆ† | 40 åˆ†é˜ | âœ… å®Œæˆ |
| 7. ä¸»çµ„ä»¶é‡æ§‹ | 15 åˆ†é˜ | âœ… å®Œæˆ |
| 8. å…¼å®¹å±¤å‰µå»º | 5 åˆ†é˜ | âœ… å®Œæˆ |
| 9. æ–‡æª”æ’°å¯« | 30 åˆ†é˜ | âœ… å®Œæˆ |
| **ç¸½è¨ˆ** | **145 åˆ†é˜** | âœ… å®Œæˆ |

## æˆåŠŸæŒ‡æ¨™

### âœ… é”æˆç›®æ¨™
1. âœ… æ‰€æœ‰æ–‡ä»¶ < 210 è¡Œ (14/15 < 200 è¡Œ)
2. âœ… æ¨¡å¡ŠåŒ–æ¶æ§‹æ¸…æ™°
3. âœ… å‘å¾Œå…¼å®¹æ€§å®Œæ•´
4. âœ… é¡å‹å®‰å…¨ä¿è­‰
5. âœ… æ–‡æª”å®Œæ•´

### ğŸ“Š é‡åŒ–æŒ‡æ¨™
- **æ–‡ä»¶æ•¸é‡**: 1 â†’ 15 (æ¨¡å¡ŠåŒ–æå‡ 15x)
- **æœ€å¤§æ–‡ä»¶è¡Œæ•¸**: 923 â†’ 210 (æ¸›å°‘ 77%)
- **å¹³å‡æ–‡ä»¶è¡Œæ•¸**: 923 â†’ 68 (æ¸›å°‘ 93%)
- **é¡å‹è¦†è“‹ç‡**: 100% (ç„¡ `any`)
- **æ–‡æª”å®Œæ•´åº¦**: 100% (ARCHITECTURE.md + MIGRATION_REPORT.md)

## ä¸‹ä¸€æ­¥è¡Œå‹•

### ç«‹å³è¡Œå‹• (å„ªå…ˆ)
1. âš ï¸ **æ‰‹å‹•æ¸¬è©¦é©—è­‰** (å¿…é ˆ)
   - åŸ·è¡Œå®Œæ•´æ¸¬è©¦æ¸…å–®
   - é©—è­‰æ‰€æœ‰åŠŸèƒ½æ­£å¸¸

2. âš ï¸ **æ›´æ–°ç›¸é—œæ–‡æª”** (å¿…é ˆ)
   - æ›´æ–° README.md æåŠæ–°æ¶æ§‹
   - æ›´æ–°çµ„ä»¶ä½¿ç”¨æŒ‡å—

### çŸ­æœŸæ”¹é€² (1-2 é€±)
3. ğŸ“ **æ·»åŠ å–®å…ƒæ¸¬è©¦**
   - å·¥å…·å‡½æ•¸æ¸¬è©¦ (fontMapping, styleConverters)
   - çµ„ä»¶æ¸²æŸ“æ¸¬è©¦ (StyleCard, ParagraphCard, TableCard)

4. ğŸ¨ **è¦–è¦ºå›æ­¸æ¸¬è©¦**
   - ä½¿ç”¨ Playwright æˆªåœ–å°æ¯”
   - ç¢ºä¿ UI æ¸²æŸ“ä¸€è‡´

### é•·æœŸå„ªåŒ– (1-2 æœˆ)
5. âš¡ **æ•ˆèƒ½å„ªåŒ–**
   - ä½¿ç”¨ React.memo åŒ…è£çµ„ä»¶
   - é•·åˆ—è¡¨è™›æ“¬æ»¾å‹• (å¦‚éœ€è¦)

6. ğŸ” **åŠŸèƒ½å¢å¼·**
   - æœå°‹/éæ¿¾åŠŸèƒ½
   - åŒ¯å‡ºåŠŸèƒ½
   - æ¨£å¼å°æ¯”å·¥å…·

## çµè«–

StructureView æ‹†åˆ†é·ç§»å·²æˆåŠŸå®Œæˆ,é”åˆ°ä»¥ä¸‹æˆæœ:

âœ… **ä»£ç¢¼å“è³ª**: æ‰€æœ‰æ–‡ä»¶ â‰¤ 210 è¡Œ,æ¨¡å¡ŠåŒ–æ¸…æ™°
âœ… **æ¶æ§‹è¨­è¨ˆ**: é—œæ³¨é»åˆ†é›¢,å–®ä¸€è·è²¬
âœ… **å‘å¾Œå…¼å®¹**: å®Œå…¨å…¼å®¹ç¾æœ‰ä»£ç¢¼
âœ… **é¡å‹å®‰å…¨**: 100% TypeScript è¦†è“‹
âœ… **æ–‡æª”å®Œæ•´**: æ¶æ§‹æ–‡æª” + é·ç§»å ±å‘Š

**å”¯ä¸€é¢¨éšª**: ç¼ºä¹è‡ªå‹•åŒ–æ¸¬è©¦ â†’ éœ€è¦æ‰‹å‹•é©—è­‰

**æ¨è–¦**: ç«‹å³åŸ·è¡Œæ‰‹å‹•æ¸¬è©¦æ¸…å–®,ç¢ºä¿åŠŸèƒ½æ­£å¸¸ã€‚

---

**é·ç§»åŸ·è¡Œè€…**: å‰ç«¯å·¥ç¨‹å¸« Ava
**é·ç§»æ—¥æœŸ**: 2026-01-26
**ç‹€æ…‹**: âœ… å®Œæˆ
